<!DOCTYPE html>
<html>
	<head>Test page</head>
	<body>
		<p>This is a little test</p>
		<p id="second-paragraph">Second paragraph</p>
		<p class="changing-paragraph">Nth paragraph</p>
		<script>
			const secondRef = new WeakRef(document.querySelector('#second-paragraph').firstChild);

			const thirdRef = new WeakRef(document.querySelector('.changing-paragraph').firstChild);

			let serial = 0;

			document.body.addEventListener('click', e => {
				console.log('[Test page] second ref = ', secondRef.deref());
				console.log('[Test page] third ref = ', thirdRef.deref());

				const p = document.querySelector('.changing-paragraph');
				const newP = document.createElement('p');
				newP.classList.add('changing-paragraph');
				newP.appendChild(document.createTextNode(`Paragraph number ${++serial}`));
				p.parentNode.replaceChild(newP, p);
			});

		</script>
	</body>
</html>